<div class="dashboard-container">
  <h1>Admin Dashboard</h1>
  
  <!-- Statistics Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <h3>Total Users</h3>
      <div class="stat-number">{{ stats.totalUsers }}</div>
    </div>
    
    <div class="stat-card">
      <h3>Total Tasks</h3>
      <div class="stat-number">{{ stats.totalTasks }}</div>
    </div>
    
    <div class="stat-card">
      <h3>Completed Tasks</h3>
      <div class="stat-number">{{ stats.completedTasks }}</div>
    </div>
    
    <div class="stat-card">
      <h3>Pending Tasks</h3>
      <div class="stat-number">{{ stats.pendingTasks }}</div>
    </div>
    
    <div class="stat-card">
      <h3>High Priority</h3>
      <div class="stat-number">{{ stats.highPriorityTasks }}</div>
    </div>
  </div>

  <!-- Users Management -->
  <div class="section">
    <h2>Users Management</h2>
    <div class="table-container">
      <table class="data-table" *ngIf="users.length > 0">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Created Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of users">
            <td>{{ user.firstName }} {{ user.lastName }}</td>
            <td>{{ user.email }}</td>
            <td>
              <span class="role-badge" [class.admin]="user.role === 'admin'">
                {{ user.role | titlecase }}
              </span>
            </td>
            <td>{{ user.createdAt | date:'short' }}</td>
            <td>
              <div class="action-buttons">
                <button 
                  class="btn-edit" 
                  (click)="editUser(user)"
                  [disabled]="user.role === 'admin'">
                  Edit
                </button>
                <button 
                  class="btn-delete" 
                  (click)="deleteUser(user.id)"
                  [disabled]="user.role === 'admin'">
                  Delete
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Tasks Management -->
  <div class="section">
    <h2>All Tasks</h2>
    <div class="table-container">
      <table class="data-table" *ngIf="tasks.length > 0">
        <thead>
          <tr>
            <th>Task Name</th>
            <th>Assigned To</th>
            <th>Priority</th>
            <th>Status</th>
            <th>Due Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of tasks">
            <td>{{ task.name }}</td>
            <td>{{ getUserName(task.userId) }}</td>
            <td>
              <span class="priority" [class]="getPriorityClass(task.priority)">
                {{ task.priority }}
              </span>
            </td>
            <td>
              <span class="status" [class]="getStatusClass(task.status)">
                {{ task.status }}
              </span>
            </td>
            <td>{{ task.dueDate | date:'short' }}</td>
            <td>
              <button class="btn-delete" (click)="deleteTask(task.id)">
                Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Edit User Modal -->
  <div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Edit User</h3>
        <button class="close-btn" (click)="closeEditModal()">&times;</button>
      </div>
      
      <form (ngSubmit)="saveUserChanges()" #editForm="ngForm">
        <div class="form-group">
          <label for="editFirstName">First Name:</label>
          <input 
            type="text" 
            id="editFirstName" 
            [(ngModel)]="editUserForm.firstName" 
            name="firstName" 
            required
            class="form-control">
        </div>
        
        <div class="form-group">
          <label for="editLastName">Last Name:</label>
          <input 
            type="text" 
            id="editLastName" 
            [(ngModel)]="editUserForm.lastName" 
            name="lastName" 
            required
            class="form-control">
        </div>
        
        <div class="form-group">
          <label for="editEmail">Email:</label>
          <input 
            type="email" 
            id="editEmail" 
            [(ngModel)]="editUserForm.email" 
            name="email" 
            required
            class="form-control">
        </div>
        
        <div class="form-group">
          <label for="editRole">Role:</label>
          <select 
            id="editRole" 
            [(ngModel)]="editUserForm.role" 
            name="role" 
            class="form-control">
            <option value="user">User</option>
            <option value="admin">Admin</option>
          </select>
        </div>
        
        <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>
        <div class="success" *ngIf="successMessage">{{ successMessage }}</div>
        
        <div class="modal-actions">
          <button type="button" class="btn-cancel" (click)="closeEditModal()">Cancel</button>
          <button type="submit" class="btn-save" [disabled]="!editForm.valid">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <div class="no-data" *ngIf="users.length === 0 && tasks.length === 0">
    <p>No data available</p>
  </div>
</div>
